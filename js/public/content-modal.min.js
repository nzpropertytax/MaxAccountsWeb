(function(){"use strict";function f(){if(!u){if(i=document.getElementById("contentDetailModal"),!i){console.warn("Content modal element not found. Modal functionality disabled.");return}t=new bootstrap.Modal(i);r=document.getElementById("contentDetailModalTitle");n=document.getElementById("contentDetailModalBody");document.addEventListener("click",s);i.addEventListener("show.bs.modal",h);u=!0}}function s(n){const t=n.target.closest("[data-content-modal]");if(t){n.preventDefault();n.stopPropagation();const i=t.dataset.contentId,r=t.dataset.contentType||"page-content",u=t.dataset.title||"Details";if(!i){console.error("Content modal trigger missing data-content-id attribute");return}o(i,r,u)}}function h(t){const i=t.relatedTarget;if(i){const r=i.dataset.contentId;if(r){const u=document.getElementById("modal-content-"+r);if(u){n.innerHTML=u.innerHTML;return}}}}function o(i,u,e){if(!t&&(f(),!t)){console.error("Modal not available");return}const o=document.getElementById("modal-content-"+i);if(o){r.textContent=e;n.innerHTML=o.innerHTML;t.show();return}c(e);t.show();l(i,u)}function c(t){r.textContent=t;n.innerHTML=`
            <div class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3 text-muted">Loading content...</p>
            </div>
        `}function e(t){n.innerHTML=`
            <div class="alert alert-danger mb-0">
                <i class="fa fa-exclamation-triangle me-2"></i>
                ${v(t||"Failed to load content. Please try again.")}
            </div>
        `}async function l(t,i){try{const r=await fetch(`/api/content-modal/${i}/${encodeURIComponent(t)}`);if(!r.ok){r.status===404?e("Content not found."):e(`Failed to load content (${r.status}).`);return}const u=await r.text();n.innerHTML=u;a()}catch(r){console.error("Error loading modal content:",r);e("Failed to load content. Please check your connection and try again.")}}function a(){const t=n.querySelectorAll('[data-bs-toggle="tooltip"]');t.forEach(n=>new bootstrap.Tooltip(n));const i=n.querySelectorAll(".carousel");i.forEach(n=>new bootstrap.Carousel(n))}function v(n){const t=document.createElement("div");return t.textContent=n,t.innerHTML}let t=null,i=null,r=null,n=null,u=!1;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f();window.contentModal={show:function(n,t,i){o(n,t||"page-content",i||"Details")},hide:function(){t&&t.hide()},isReady:function(){return u}}})()